syntax = "proto3";
package global_scheduler_service;

message RegisterRequest {
	string address = 1;
	repeated string fn_names = 2;
}

message RegisterResponse {
	fixed64 lifetime_id = 1;
	fixed64 heart_beat_timeout = 2;
}

message HeartBeatRequest {
	string address = 1;
	fixed64 lifetime_id = 2;
	fixed64 lifetime_list_id = 3;
}

// Lifetime of each peer. We'll use this to know when a peer has failed.
message Lifetime {
	string address = 1;
	fixed64 lifetime_id = 2;
}

message HeartBeatResponse {
	fixed64 lifetime_id = 1;
	fixed64 lifetime_list_id = 2;
	repeated Lifetime lifetimes = 3;
}

message ScheduleRequest {
	string fn_name = 1;
}

message ScheduleResponse {
	optional string address = 1;
}

message UnRegisterRequest {
	string address = 1;
}

message UnRegisterResponse {
}

service GlobalSchedulerService {
	rpc Register(RegisterRequest) returns (RegisterResponse);
	rpc HeartBeat(HeartBeatRequest) returns (HeartBeatResponse);
	rpc Schedule(ScheduleRequest) returns (ScheduleResponse);
	rpc UnRegister(UnRegisterRequest) returns (UnRegisterResponse);
	// TODO: Rpc for cli. 
	// rpc Status(StatusRequest) returns (StatusResponse);
	// rpc Shutdown(ShutdownRequest) returns (ShutdownResponse);
}
